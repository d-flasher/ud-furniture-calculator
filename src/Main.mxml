<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
                       xmlns:s="library://ns.adobe.com/flex/spark"
                       xmlns:mx="library://ns.adobe.com/flex/mx"
					   width="1000" height="700"
					   initialize="windowedapplication_initializeHandler(event)">
	<fx:Script>
		<![CDATA[

		import flash.events.MouseEvent;
		import mx.collections.ArrayCollection;
		import mx.events.FlexEvent;
		import mx.events.ResizeEvent;
		import spark.components.DropDownList;
		import spark.components.FormItem;
		import spark.components.Button;
		import spark.layouts.HorizontalLayout;

			private const DOOR_TYPES:ArrayCollection = new ArrayCollection([
				{label: "ДСП" },
				{label: "Зеркало" }
			]);

		private function addDoorButtonClick(event:MouseEvent):void
		{
			var doorFormItem:FormItem = new FormItem();
			doorFormItem.layout = new HorizontalLayout();

			var doorTypeMenu:DropDownList = new DropDownList();
			doorTypeMenu.dataProvider = DOOR_TYPES;
			doorTypeMenu.requireSelection = true;
			doorFormItem.addElement(doorTypeMenu);

			var removeDoorItemButton:Button = new Button();
			removeDoorItemButton.alpha = 0.6
			removeDoorItemButton.label = "Удалить";
			removeDoorItemButton.width = 70;
			removeDoorItemButton.addEventListener(MouseEvent.CLICK, onRemoveDoorButtonClick);
			doorFormItem.addElement(removeDoorItemButton);

			doorsItemsContainer.addElement(doorFormItem);

			refreshDoorsLabel();
		}

		private function onRemoveDoorButtonClick(event:MouseEvent):void
		{
			var button:Button = event.currentTarget as Button;
			var formItem:FormItem = button.owner as FormItem;

			doorsItemsContainer.removeElement(formItem);

			refreshDoorsLabel();
		}

		private function refreshDoorsLabel():void
		{
			for (var i:int = 0; i < doorsItemsContainer.numElements; i++)
			{
				var doorItem:FormItem = doorsItemsContainer.getElementAt(i) as FormItem;
				if (doorItem != null)
				{
					doorItem.label = "Дверь " + (i + 1);
				}
			}
		}

		//-----------------------------------------------------------------------------------------------------------------------
		//
		//-----------------------------------------------------------------------------------------------------------------------

		private const APP_TITLE:String = "Калькулятор мебели";

		protected function windowedapplication_initializeHandler(event:FlexEvent):void
		{
			this.title = APP_TITLE;

			addEventListener(ResizeEvent.RESIZE, resizeHandler);
		}

		protected function resizeHandler(event:ResizeEvent):void
		{
			formContainer.height = mainPanel.contentGroup.height;
		}

		]]>
	</fx:Script>

	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>

	<s:Panel id="mainPanel" width="100%" height="100%" title="{APP_TITLE}">

		<s:Scroller>
			<s:Group id="formContainer" width="{mainPanel.contentGroup.width}" height="{mainPanel.contentGroup.height}">
				<s:Form width="100%">

					<s:FormItem label="Длина шкафа общая*:">
						<s:TextInput/>
					</s:FormItem>

					<s:FormItem label="Высотка шкафа*:">
						<s:TextInput/>
					</s:FormItem>

					<s:FormItem label="Глубина шкафа*:">
						<s:TextInput/>
					</s:FormItem>

					<mx:HRule width="100%"/>

					<s:FormItem label="Двери">
						<!--<s:NumericStepper id="doorsNStepper" minimum="0" maximum="10" value="1" valueCommit="doorsNStepper_valueCommit(event)" />-->
						<s:Button label="добавить дверь" alpha="0.6" click="addDoorButtonClick(event)" />
						<s:VGroup id="doorsItemsContainer"/>
					</s:FormItem>

					<mx:HRule width="100%"/>

					<s:FormItem label=" Количество вертикальных стоек, шт.">
						<s:NumericStepper minimum="0" maximum="60"/>
					</s:FormItem>

					<s:FormItem label="Количество полок, шт.">
						<s:NumericStepper minimum="0" maximum="40"/>
					</s:FormItem>

					<s:FormItem label="Количество ящиков, шт.">
						<s:NumericStepper minimum="0" maximum="40"/>
					</s:FormItem>

					<mx:HRule width="100%"/>

				</s:Form>
			</s:Group>
		</s:Scroller>

		<s:controlBarContent>
			<s:HGroup width="100%">
				<mx:Spacer width="100%"/>
				<s:Button label="Рассчитать"/>
			</s:HGroup>
		</s:controlBarContent>
	</s:Panel>

</s:WindowedApplication>